function assert(e,t){if(!e){var n="";throw assert.caller&&assert.caller.name&&(n=assert.caller.name+": "),n+=t,new Error(n)}}function hideAndShow(){function e(){return Date.now()-c<l?!1:(c=Date.now(),!0)}function t(){return window.innerWidth<=768}function n(){document.body.classList.add(i)}function o(){document.body.classList.remove(i)}var r=document.querySelector(".js-navbar-toggle-button"),a=document.querySelector(".navbar"),i="show-navbar",l=100,c=Date.now();r.addEventListener("mouseenter",function(){!t()&&e()&&n()}),a.addEventListener("mouseleave",function(){!t()&&e()&&o()})}function activeButton(e){var t=void 0,n=void 0,o=document.querySelector(".navigation-buttons");if(e&&(t=e,t=CSS.escape(t),n=o.querySelector("[name="+t+"]")),n||"object"!==("undefined"==typeof PAGE_INFO?"undefined":babelHelpers["typeof"](PAGE_INFO))||"string"!=typeof PAGE_INFO.name||(t=PAGE_INFO.name,t=CSS.escape(t),n=o.querySelector("[name="+t+"]")),!n){var r=location.pathname,a=/\/([^\.]+)(?:\..*)?$/,i=r.match(a)||[];t=i[1],t=CSS.escape(t),n=o.querySelector("[name="+t+"]")}if(n){assert(n,"Error finding navbar's active button.");var l=o.querySelectorAll("li");assert(l&&l.length>0,"No navigation buttons found"),l=Array.from(l);var c=!0,u=!1,s=void 0;try{for(var d,v=l[Symbol.iterator]();!(c=(d=v.next()).done);c=!0){var f=d.value;if(f.querySelector(".navbar-button")){var m=l.indexOf(f);l.splice(m,1)}}}catch(h){u=!0,s=h}finally{try{!c&&v["return"]&&v["return"]()}finally{if(u)throw s}}new ActiveHighlighter({buttons:l,activeIndex:l.indexOf(n),highlightOnClick:!0})}}function initSearchBarToggle(){function e(){i.classList.add(u),document.body.addEventListener("click",n)}function t(){i.classList.remove(u),document.body.removeEventListener("click",n)}function n(e){var n=c.getBoundingClientRect(),o=e.clientX<n.right&&e.clientX>n.left,r=e.clientY<n.bottom&&e.clientY>n.top;r&&o||t()}var o=".website-search",r=document.querySelector(o);assert(r&&r.nodeName,"No search button found.");var a=".navbar-container",i=document.querySelector(a);assert(i&&i.nodeName,"No navbar container found.");var l=".navbar-dropdown-search",c=document.querySelector(l);assert(c&&c.nodeName,"No navbar dropdown found.");var u="dropdown-search-open";r.addEventListener("click",function(n){i.classList.contains(u)?t():(n.stopPropagation(),e())})}function initSearchBarButtons(){var e=".js-navbar-dropdown-search",t=document.querySelector(e);assert(t&&t.nodeName,"No search form found.");var n=".js-navbar-dropdow-search-rent-btn",o="/rent",r=document.querySelector(n);assert(r&&r.nodeName,"No rent button found."),r.addEventListener("click",function(){t.action=o,t.submit()})}function controlNavbar(e){hideAndShow(),activeButton(e),initSearchBarToggle(),initSearchBarButtons()}var babelHelpers={};babelHelpers["typeof"]="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},babelHelpers.classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},babelHelpers.createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var Highlight=function(){function e(t){babelHelpers.classCallCheck(this,e),this.setActive(t)}return babelHelpers.createClass(e,[{key:"translateX",value:function(e){assert("number"==typeof e,"translateX value is not a number"),this.bar.style.transform="translate3d("+e+"px, 0, 0)"}},{key:"setWidth",value:function(e){assert("number"==typeof e,"translateX value is not a number"),this.bar.style.width=e+"px"}},{key:"getBaseXPosition",value:function(){var e=this.parent.getBoundingClientRect();return e.left}},{key:"returnToBasePosition",value:function(){this.translateX(0);var e=this.parent.getBoundingClientRect(),t=e.right-e.left;this.setWidth(t)}},{key:"moveToElementPosition",value:function(e){var t=this.getBaseXPosition(),n=e.getBoundingClientRect(),o=n.left-t;this.translateX(o);var r=n.right-n.left;this.setWidth(r)}},{key:"setActive",value:function(e){this.bar&&(this.bar.remove(),this.bar=null),assert(e&&e.nodeName,"Invalid element passed to setActive"),this.parent=e,this.bar=document.createElement("div"),this.bar.classList.add("active-highlight"),this.parent.appendChild(this.bar)}}]),e}(),ActiveHighlighter=function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.buttons,o=t.activeIndex,r=void 0===o?0:o,a=t.highlightOnClick,i=void 0===a?!1:a;babelHelpers.classCallCheck(this,e);var l=void 0,c=void 0;if(n.nodeName)l=Array.from(n.children),c=n;else{if(!n.length)throw new Error("Invalid element send to ActiveHighlighter.");l=Array.from(n),c=l[0].parentElement}var u=new Highlight(l[r]);c.addEventListener("mouseleave",function(e){var t=c.getBoundingClientRect(),n=e.pageX>t.right||e.pageX<t.left,o=e.pageY>t.bottom||e.pageY<t.top,r=n||o;r&&u.returnToBasePosition()});var s=!0,d=!1,v=void 0;try{for(var f,m=function(){var e=f.value;e.addEventListener("mouseenter",function(){u.moveToElementPosition(e)})},h=l[Symbol.iterator]();!(s=(f=h.next()).done);s=!0)m()}catch(b){d=!0,v=b}finally{try{!s&&h["return"]&&h["return"]()}finally{if(d)throw v}}if(i){var p=!0,y=!1,g=void 0;try{for(var w,A=function(){var e=w.value;e.addEventListener("click",function(){u.setActive(e)})},E=l[Symbol.iterator]();!(p=(w=E.next()).done);p=!0)A()}catch(b){y=!0,g=b}finally{try{!p&&E["return"]&&E["return"]()}finally{if(y)throw g}}}},Elevator=function(e){"use strict";function t(e,t,n,o){return e/=o/2,1>e?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t)}function n(e,t){for(var n in t){var o=void 0===e[n]&&"function"!=typeof n;o&&(e[n]=t[n])}return e}function o(e){for(var t=0;e;)t+=e.offsetTop||0,e=e.offsetParent;return t}function r(e){w||(w=e);var n=e-w,o=t(n,A,E-A,y);window.scrollTo(0,o),y>n?p=requestAnimationFrame(r):c()}function a(){return window.requestAnimationFrame&&window.Audio&&window.addEventListener}function i(){w=null,A=null,C=!1}function l(){S&&(E=o(S))}function c(){i(),f&&(f.pause(),f.currentTime=0),m&&m.play(),h&&h()}function u(){C&&(cancelAnimationFrame(p),i(),f&&(f.pause(),f.currentTime=0),l(),window.scrollTo(0,E))}function s(e){e.addEventListener?e.addEventListener("click",k.elevate,!1):e.attachEvent("onclick",function(){l(),document.documentElement.scrollTop=E,document.body.scrollTop=E,window.scroll(0,E)})}function d(e){b=document.body;var t={duration:void 0,mainAudio:!1,endAudio:!1,preloadAudio:!0,loopAudio:!0,startCallback:null,endCallback:null};e=n(e,t),e.element&&s(e.element),a()&&(e.duration&&(g=!0,y=e.duration),e.targetElement&&(S=e.targetElement),window.addEventListener("blur",u,!1),e.mainAudio&&(f=new Audio(e.mainAudio),f.setAttribute("preload",e.preloadAudio),f.setAttribute("loop",e.loopAudio)),e.endAudio&&(m=new Audio(e.endAudio),m.setAttribute("preload","true")),e.endCallback&&(h=e.endCallback),e.startCallback&&(v=e.startCallback))}var v,f,m,h,b=null,p=null,y=null,g=!1,w=null,A=null,E=0,S=null,C=!1,k=this;this.elevate=function(){C||(C=!0,A=document.documentElement.scrollTop||b.scrollTop,l(),g||(y=1.5*Math.abs(E-A)),requestAnimationFrame(r),f&&f.play(),v&&v())},d(e)};controlNavbar(),window.elevator=Elevator;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbW1vbi5qcyJdLCJuYW1lcyI6WyJhc3NlcnQiLCJjb25kaXRpb24iLCJlcnJvck1lc3NhZ2UiLCJjb21wbGV0ZUVycm9yTWVzc2FnZSIsImNhbGxlciIsIm5hbWUiLCJFcnJvciIsImhpZGVBbmRTaG93IiwiZW5vdWdoRGVsYXkiLCJEYXRlIiwibm93IiwibGFzdE5hdmJhckNoYW5nZSIsIm1pbmltdW1EZWxheSIsImlzU21hbGxTY3JlZW4iLCJ3aW5kb3ciLCJpbm5lcldpZHRoIiwic2hvd05hdmJhciIsImRvY3VtZW50IiwiYm9keSIsImNsYXNzTGlzdCIsImFkZCIsInNob3dOYXZiYXJDbGFzcyIsImhpZGVOYXZiYXIiLCJyZW1vdmUiLCJ0b2dnbGVOYXZiYXJCdG4iLCJxdWVyeVNlbGVjdG9yIiwibmF2YmFyIiwiYWRkRXZlbnRMaXN0ZW5lciIsImFjdGl2ZUJ1dHRvbiIsInBhZ2VOYW1lUGFyYW0iLCJwYWdlTmFtZSIsIm5hdmJhckFjdGl2ZUJ1dHRvbiIsImJ1dHRvbnNDb250YWluZXIiLCJDU1MiLCJlc2NhcGUiLCJQQUdFX0lORk8iLCJiYWJlbEhlbHBlcnMiLCJwYXRobmFtZSIsImxvY2F0aW9uIiwicGFnZU5hbWVSZWdleCIsInBhZ2VOYW1lTWF0Y2giLCJtYXRjaCIsIm5hdmJhckJ1dHRvbnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwibGVuZ3RoIiwiQXJyYXkiLCJmcm9tIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiIsIl9kaWRJdGVyYXRvckVycm9yIiwiX2l0ZXJhdG9yRXJyb3IiLCJ1bmRlZmluZWQiLCJfc3RlcCIsIl9pdGVyYXRvciIsIlN5bWJvbCIsIml0ZXJhdG9yIiwibmV4dCIsImRvbmUiLCJpdGVtIiwidmFsdWUiLCJpdGVtSW5kZXgiLCJpbmRleE9mIiwic3BsaWNlIiwiZXJyIiwiQWN0aXZlSGlnaGxpZ2h0ZXIiLCJidXR0b25zIiwiYWN0aXZlSW5kZXgiLCJoaWdobGlnaHRPbkNsaWNrIiwiaW5pdFNlYXJjaEJhclRvZ2dsZSIsInNob3dTZWFyY2hCYXIiLCJuYXZiYXJDb250YWluZXIiLCJzZWFyY2hCYXJPcGVuQ2xhc3MiLCJzZWFyY2hEaXNtaXNzIiwiaGlkZVNlYXJjaEJhciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJlIiwiZHJvcGRvd25Cb3giLCJuYXZiYXJEcm9wZG93biIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImNsaWNrV2lkdGhpblgiLCJjbGllbnRYIiwicmlnaHQiLCJsZWZ0IiwiY2xpY2tXaWR0aGluWSIsImNsaWVudFkiLCJib3R0b20iLCJ0b3AiLCJzZWFyY2hCdXR0b25TZWxlY3RvciIsInNlYXJjaEJ1dHRvbiIsIm5vZGVOYW1lIiwibmF2YmFyQ29udGFpbmVyU2VsZWN0b3IiLCJuYXZiYXJEcm9wZG93blNlbGVjdG9yIiwiY29udGFpbnMiLCJzdG9wUHJvcGFnYXRpb24iLCJpbml0U2VhcmNoQmFyQnV0dG9ucyIsInNlYXJjaEZvcm1TZWxlY3RvciIsInNlYXJjaEZvcm0iLCJyZW50QnRuU2VsZWN0b3IiLCJyZW50QnRuVGFyZ2V0IiwicmVudEJ0biIsImFjdGlvbiIsInN1Ym1pdCIsImNvbnRyb2xOYXZiYXIiLCJvYmoiLCJjb25zdHJ1Y3RvciIsImNsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsImNyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiaSIsImRlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIkhpZ2hsaWdodCIsImVsIiwidGhpcyIsInNldEFjdGl2ZSIsInZhbCIsImJhciIsInN0eWxlIiwidHJhbnNmb3JtIiwid2lkdGgiLCJwYXJlbnRCb3giLCJwYXJlbnQiLCJ0cmFuc2xhdGVYIiwicGFyZW50V2lkdGgiLCJzZXRXaWR0aCIsImJhc2VQb3MiLCJnZXRCYXNlWFBvc2l0aW9uIiwiZWxCb3giLCJkaXNwbGFjZW1lbnQiLCJlbFdpZHRoIiwiY3JlYXRlRWxlbWVudCIsImFwcGVuZENoaWxkIiwiX3JlZiIsImFyZ3VtZW50cyIsIl9yZWYkYWN0aXZlSW5kZXgiLCJfcmVmJGhpZ2hsaWdodE9uQ2xpY2siLCJidXR0b25zQXJyYXkiLCJ0YWJzUGFyZW50IiwiY2hpbGRyZW4iLCJwYXJlbnRFbGVtZW50IiwiYWN0aXZlSGlnaGxpZ2h0IiwidGFic1BhcnRlbnRCb3giLCJvdXRzaWRlWCIsInBhZ2VYIiwib3V0c2lkZVkiLCJwYWdlWSIsIm1vdXNlT3V0T2ZUYWJzUGFyZW50IiwicmV0dXJuVG9CYXNlUG9zaXRpb24iLCJfbG9vcDIiLCJtb3ZlVG9FbGVtZW50UG9zaXRpb24iLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiIsIl9kaWRJdGVyYXRvckVycm9yMiIsIl9pdGVyYXRvckVycm9yMiIsIl9zdGVwMiIsIl9sb29wIiwiX2l0ZXJhdG9yMiIsIkVsZXZhdG9yIiwibiIsInQiLCJvIiwib2Zmc2V0VG9wIiwib2Zmc2V0UGFyZW50IiwibCIsIlQiLCJrIiwiQyIsImIiLCJzY3JvbGxUbyIsInciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJyIiwiQXVkaW8iLCJ1IiwiaCIsImEiLCJ5IiwiZiIsInBhdXNlIiwiY3VycmVudFRpbWUiLCJBIiwicGxheSIsInAiLCJkIiwiY2FuY2VsQW5pbWF0aW9uRnJhbWUiLCJjIiwiRiIsImVsZXZhdGUiLCJhdHRhY2hFdmVudCIsImRvY3VtZW50RWxlbWVudCIsInNjcm9sbFRvcCIsInNjcm9sbCIsInMiLCJ2IiwiZHVyYXRpb24iLCJtYWluQXVkaW8iLCJlbmRBdWRpbyIsInByZWxvYWRBdWRpbyIsImxvb3BBdWRpbyIsInN0YXJ0Q2FsbGJhY2siLCJlbmRDYWxsYmFjayIsImVsZW1lbnQiLCJFIiwidGFyZ2V0RWxlbWVudCIsInNldEF0dHJpYnV0ZSIsIm0iLCJNYXRoIiwiYWJz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LGdCQUMza0IsR0FBSU0sR0FDRDVCLEVBQ0FHLEVBQ0FFLEVBQ0FXLEVBQUksS0FDSnhCLEVBQUksS0FDSkYsRUFBSSxLQUNKbUMsR0FBSSxFQUNKdEMsRUFBSSxLQUNKQyxFQUFJLEtBQ0pDLEVBQUksRUFDSlUsRUFBSSxLQUNKRixHQUFJLEVBQ0pZLEVBQUl4RSxJQUFLQSxNQUFLeUUsUUFBVSxXQUMxQmIsSUFBTUEsR0FBSSxFQUFJVCxFQUFJL0osU0FBU3VMLGdCQUFnQkMsV0FBYUcsRUFBRUgsVUFBV2YsSUFBSzJCLElBQU1uQyxFQUFJLElBQU11QyxLQUFLQyxJQUFJekMsRUFBSUQsSUFBS0ssc0JBQXNCUCxHQUFJYyxHQUFLQSxFQUFFSSxPQUFRd0IsR0FBS0EsTUFDekpiLEVBQUVsQyxHQUdQcEUsaUJBRUF2RixPQUFPNk0sU0FBV25EIiwiZmlsZSI6ImNvbW1vbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBiYWJlbEhlbHBlcnMgPSB7fTtcbmJhYmVsSGVscGVycy50eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHtcbiAgcmV0dXJuIHR5cGVvZiBvYmo7XG59IDogZnVuY3Rpb24gKG9iaikge1xuICByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqO1xufTtcblxuYmFiZWxIZWxwZXJzLmNsYXNzQ2FsbENoZWNrID0gZnVuY3Rpb24gKGluc3RhbmNlLCBDb25zdHJ1Y3Rvcikge1xuICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkge1xuICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7XG4gIH1cbn07XG5cbmJhYmVsSGVscGVycy5jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykge1xuICAgICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTtcbiAgICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTtcbiAgICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTtcbiAgICAgIGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7XG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHtcbiAgICBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpO1xuICAgIGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpO1xuICAgIHJldHVybiBDb25zdHJ1Y3RvcjtcbiAgfTtcbn0oKTtcblxuYmFiZWxIZWxwZXJzO1xuXG4vLyBCdWcgY2hlY2tpbmcgZnVuY3Rpb24gdGhhdCB3aWxsIHRocm93IGFuIGVycm9yIHdoZW5ldmVyXG4vLyB0aGUgY29uZGl0aW9uIHNlbnQgdG8gaXQgaXMgZXZhbHVhdGVkIHRvIGZhbHNlXG5mdW5jdGlvbiBhc3NlcnQoY29uZGl0aW9uLCBlcnJvck1lc3NhZ2UpIHtcbiAgaWYgKCFjb25kaXRpb24pIHtcbiAgICB2YXIgY29tcGxldGVFcnJvck1lc3NhZ2UgPSAnJztcblxuICAgIGlmIChhc3NlcnQuY2FsbGVyICYmIGFzc2VydC5jYWxsZXIubmFtZSkge1xuICAgICAgY29tcGxldGVFcnJvck1lc3NhZ2UgPSBhc3NlcnQuY2FsbGVyLm5hbWUgKyAnOiAnO1xuICAgIH1cblxuICAgIGNvbXBsZXRlRXJyb3JNZXNzYWdlICs9IGVycm9yTWVzc2FnZTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoY29tcGxldGVFcnJvck1lc3NhZ2UpO1xuICB9XG59XG5cbnZhciBIaWdobGlnaHQgPSBmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEhpZ2hsaWdodChlbCkge1xuICAgIGJhYmVsSGVscGVycy5jbGFzc0NhbGxDaGVjayh0aGlzLCBIaWdobGlnaHQpO1xuXG4gICAgdGhpcy5zZXRBY3RpdmUoZWwpO1xuICB9XG5cbiAgYmFiZWxIZWxwZXJzLmNyZWF0ZUNsYXNzKEhpZ2hsaWdodCwgW3tcbiAgICBrZXk6ICd0cmFuc2xhdGVYJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gdHJhbnNsYXRlWCh2YWwpIHtcbiAgICAgIGFzc2VydCh0eXBlb2YgdmFsID09PSAnbnVtYmVyJywgJ3RyYW5zbGF0ZVggdmFsdWUgaXMgbm90IGEgbnVtYmVyJyk7XG4gICAgICB0aGlzLmJhci5zdHlsZS50cmFuc2Zvcm0gPSAndHJhbnNsYXRlM2QoJyArIHZhbCArICdweCwgMCwgMCknO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ3NldFdpZHRoJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0V2lkdGgodmFsKSB7XG4gICAgICBhc3NlcnQodHlwZW9mIHZhbCA9PT0gJ251bWJlcicsICd0cmFuc2xhdGVYIHZhbHVlIGlzIG5vdCBhIG51bWJlcicpO1xuICAgICAgdGhpcy5iYXIuc3R5bGUud2lkdGggPSB2YWwgKyAncHgnO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2dldEJhc2VYUG9zaXRpb24nLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRCYXNlWFBvc2l0aW9uKCkge1xuICAgICAgdmFyIHBhcmVudEJveCA9IHRoaXMucGFyZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgcmV0dXJuIHBhcmVudEJveC5sZWZ0O1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ3JldHVyblRvQmFzZVBvc2l0aW9uJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmV0dXJuVG9CYXNlUG9zaXRpb24oKSB7XG4gICAgICB0aGlzLnRyYW5zbGF0ZVgoMCk7XG4gICAgICB2YXIgcGFyZW50Qm94ID0gdGhpcy5wYXJlbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICB2YXIgcGFyZW50V2lkdGggPSBwYXJlbnRCb3gucmlnaHQgLSBwYXJlbnRCb3gubGVmdDtcbiAgICAgIHRoaXMuc2V0V2lkdGgocGFyZW50V2lkdGgpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ21vdmVUb0VsZW1lbnRQb3NpdGlvbicsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIG1vdmVUb0VsZW1lbnRQb3NpdGlvbihlbCkge1xuICAgICAgdmFyIGJhc2VQb3MgPSB0aGlzLmdldEJhc2VYUG9zaXRpb24oKTtcbiAgICAgIHZhciBlbEJveCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgdmFyIGRpc3BsYWNlbWVudCA9IGVsQm94LmxlZnQgLSBiYXNlUG9zO1xuICAgICAgdGhpcy50cmFuc2xhdGVYKGRpc3BsYWNlbWVudCk7XG4gICAgICB2YXIgZWxXaWR0aCA9IGVsQm94LnJpZ2h0IC0gZWxCb3gubGVmdDtcbiAgICAgIHRoaXMuc2V0V2lkdGgoZWxXaWR0aCk7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnc2V0QWN0aXZlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0QWN0aXZlKGVsKSB7XG4gICAgICBpZiAodGhpcy5iYXIpIHtcbiAgICAgICAgdGhpcy5iYXIucmVtb3ZlKCk7XG4gICAgICAgIHRoaXMuYmFyID0gbnVsbDtcbiAgICAgIH1cblxuICAgICAgYXNzZXJ0KGVsICYmIGVsLm5vZGVOYW1lLCAnSW52YWxpZCBlbGVtZW50IHBhc3NlZCB0byBzZXRBY3RpdmUnKTtcbiAgICAgIHRoaXMucGFyZW50ID0gZWw7XG4gICAgICB0aGlzLmJhciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgdGhpcy5iYXIuY2xhc3NMaXN0LmFkZCgnYWN0aXZlLWhpZ2hsaWdodCcpO1xuICAgICAgdGhpcy5wYXJlbnQuYXBwZW5kQ2hpbGQodGhpcy5iYXIpO1xuICAgIH1cbiAgfV0pO1xuICByZXR1cm4gSGlnaGxpZ2h0O1xufSgpO1xuXG52YXIgQWN0aXZlSGlnaGxpZ2h0ZXIgPSBmdW5jdGlvbiBBY3RpdmVIaWdobGlnaHRlcigpIHtcbiAgdmFyIF9yZWYgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDAgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1swXTtcblxuICB2YXIgYnV0dG9ucyA9IF9yZWYuYnV0dG9ucztcbiAgdmFyIF9yZWYkYWN0aXZlSW5kZXggPSBfcmVmLmFjdGl2ZUluZGV4O1xuICB2YXIgYWN0aXZlSW5kZXggPSBfcmVmJGFjdGl2ZUluZGV4ID09PSB1bmRlZmluZWQgPyAwIDogX3JlZiRhY3RpdmVJbmRleDtcbiAgdmFyIF9yZWYkaGlnaGxpZ2h0T25DbGljayA9IF9yZWYuaGlnaGxpZ2h0T25DbGljaztcbiAgdmFyIGhpZ2hsaWdodE9uQ2xpY2sgPSBfcmVmJGhpZ2hsaWdodE9uQ2xpY2sgPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogX3JlZiRoaWdobGlnaHRPbkNsaWNrO1xuICBiYWJlbEhlbHBlcnMuY2xhc3NDYWxsQ2hlY2sodGhpcywgQWN0aXZlSGlnaGxpZ2h0ZXIpO1xuXG4gIC8vIE5PVEU6IFRoaXMgbW9kdWxlIGFzc3VtZXMgdGhhdCBhbGwgdGFicyBzaGFyZSBhIGNvbW1vbiBwYXJlbnQuXG4gIHZhciBidXR0b25zQXJyYXkgPSB2b2lkIDA7XG4gIHZhciB0YWJzUGFyZW50ID0gdm9pZCAwO1xuXG4gIGlmIChidXR0b25zLm5vZGVOYW1lKSB7XG4gICAgLy8gSWYgdGFicyBpcyBhIGNvbnRhaW5lciwgaGFuZGxlIGFsbCBjaGlsZHJlblxuICAgIGJ1dHRvbnNBcnJheSA9IEFycmF5LmZyb20oYnV0dG9ucy5jaGlsZHJlbik7XG4gICAgdGFic1BhcmVudCA9IGJ1dHRvbnM7XG4gIH0gZWxzZSBpZiAoYnV0dG9ucy5sZW5ndGgpIHtcbiAgICAvLyBJZiB0YWJzIGlzIGFycmF5bGlrZSBoYW5kbGUgYWxsIGVsZW1lbnRzIGluIHRoZSBhcnJheS5cbiAgICBidXR0b25zQXJyYXkgPSBBcnJheS5mcm9tKGJ1dHRvbnMpO1xuICAgIHRhYnNQYXJlbnQgPSBidXR0b25zQXJyYXlbMF0ucGFyZW50RWxlbWVudDtcbiAgfSBlbHNlIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgZWxlbWVudCBzZW5kIHRvIEFjdGl2ZUhpZ2hsaWdodGVyLicpO1xuICB9XG5cbiAgdmFyIGFjdGl2ZUhpZ2hsaWdodCA9IG5ldyBIaWdobGlnaHQoYnV0dG9uc0FycmF5W2FjdGl2ZUluZGV4XSk7XG5cbiAgLy8gTW92ZSBoaWdobGlnaHQgYmFjayB0byBub3JtYWwgd2hlbiBtb3VzZSBsZWF2ZXMgYnV0dG9ucyBhcmVhXG4gIHRhYnNQYXJlbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIGZ1bmN0aW9uIChlKSB7XG4gICAgdmFyIHRhYnNQYXJ0ZW50Qm94ID0gdGFic1BhcmVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICB2YXIgb3V0c2lkZVggPSBlLnBhZ2VYID4gdGFic1BhcnRlbnRCb3gucmlnaHQgfHwgZS5wYWdlWCA8IHRhYnNQYXJ0ZW50Qm94LmxlZnQ7XG4gICAgdmFyIG91dHNpZGVZID0gZS5wYWdlWSA+IHRhYnNQYXJ0ZW50Qm94LmJvdHRvbSB8fCBlLnBhZ2VZIDwgdGFic1BhcnRlbnRCb3gudG9wO1xuICAgIHZhciBtb3VzZU91dE9mVGFic1BhcmVudCA9IG91dHNpZGVYIHx8IG91dHNpZGVZO1xuICAgIGlmIChtb3VzZU91dE9mVGFic1BhcmVudCkge1xuICAgICAgYWN0aXZlSGlnaGxpZ2h0LnJldHVyblRvQmFzZVBvc2l0aW9uKCk7XG4gICAgfVxuICB9KTtcblxuICAvLyBNb3ZlIGhpZ2hsaWdodCB0byB0aGUgY29ycmVzcG9uZGluZyBlbGVtZW50IG9uIGhvdmVyLlxuICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWU7XG4gIHZhciBfZGlkSXRlcmF0b3JFcnJvciA9IGZhbHNlO1xuICB2YXIgX2l0ZXJhdG9yRXJyb3IgPSB1bmRlZmluZWQ7XG5cbiAgdHJ5IHtcbiAgICB2YXIgX2xvb3AyID0gZnVuY3Rpb24gX2xvb3AyKCkge1xuICAgICAgdmFyIGl0ZW0gPSBfc3RlcC52YWx1ZTtcblxuICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBhY3RpdmVIaWdobGlnaHQubW92ZVRvRWxlbWVudFBvc2l0aW9uKGl0ZW0pO1xuICAgICAgfSk7XG4gICAgfTtcblxuICAgIGZvciAodmFyIF9pdGVyYXRvciA9IGJ1dHRvbnNBcnJheVtTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwOyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSAoX3N0ZXAgPSBfaXRlcmF0b3IubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWUpIHtcbiAgICAgIF9sb29wMigpO1xuICAgIH1cblxuICAgIC8vIENoYW5nZSBtYWluIGhpZ2hsaWdodGVkIGVsZW1lbnQgb24gY2xpY2sgaWYgYXBwcm9wcmlhdGVcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSB0cnVlO1xuICAgIF9pdGVyYXRvckVycm9yID0gZXJyO1xuICB9IGZpbmFsbHkge1xuICAgIHRyeSB7XG4gICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gJiYgX2l0ZXJhdG9yLnJldHVybikge1xuICAgICAgICBfaXRlcmF0b3IucmV0dXJuKCk7XG4gICAgICB9XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcikge1xuICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBpZiAoaGlnaGxpZ2h0T25DbGljaykge1xuICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWU7XG4gICAgdmFyIF9kaWRJdGVyYXRvckVycm9yMiA9IGZhbHNlO1xuICAgIHZhciBfaXRlcmF0b3JFcnJvcjIgPSB1bmRlZmluZWQ7XG5cbiAgICB0cnkge1xuICAgICAgdmFyIF9sb29wID0gZnVuY3Rpb24gX2xvb3AoKSB7XG4gICAgICAgIHZhciBpdGVtID0gX3N0ZXAyLnZhbHVlO1xuXG4gICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgYWN0aXZlSGlnaGxpZ2h0LnNldEFjdGl2ZShpdGVtKTtcbiAgICAgICAgfSk7XG4gICAgICB9O1xuXG4gICAgICBmb3IgKHZhciBfaXRlcmF0b3IyID0gYnV0dG9uc0FycmF5W1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXAyOyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gKF9zdGVwMiA9IF9pdGVyYXRvcjIubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSB0cnVlKSB7XG4gICAgICAgIF9sb29wKCk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBfZGlkSXRlcmF0b3JFcnJvcjIgPSB0cnVlO1xuICAgICAgX2l0ZXJhdG9yRXJyb3IyID0gZXJyO1xuICAgIH0gZmluYWxseSB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yICYmIF9pdGVyYXRvcjIucmV0dXJuKSB7XG4gICAgICAgICAgX2l0ZXJhdG9yMi5yZXR1cm4oKTtcbiAgICAgICAgfVxuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yMikge1xuICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yMjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufTtcblxuZnVuY3Rpb24gaGlkZUFuZFNob3coKSB7XG4gIHZhciB0b2dnbGVOYXZiYXJCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuanMtbmF2YmFyLXRvZ2dsZS1idXR0b24nKTtcbiAgdmFyIG5hdmJhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uYXZiYXInKTtcbiAgdmFyIHNob3dOYXZiYXJDbGFzcyA9ICdzaG93LW5hdmJhcic7XG5cbiAgdmFyIG1pbmltdW1EZWxheSA9IDEwMDtcbiAgdmFyIGxhc3ROYXZiYXJDaGFuZ2UgPSBEYXRlLm5vdygpO1xuICBmdW5jdGlvbiBlbm91Z2hEZWxheSgpIHtcbiAgICBpZiAoRGF0ZS5ub3coKSAtIGxhc3ROYXZiYXJDaGFuZ2UgPCBtaW5pbXVtRGVsYXkpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgbGFzdE5hdmJhckNoYW5nZSA9IERhdGUubm93KCk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBmdW5jdGlvbiBpc1NtYWxsU2NyZWVuKCkge1xuICAgIHJldHVybiB3aW5kb3cuaW5uZXJXaWR0aCA8PSA3Njg7XG4gIH1cblxuICBmdW5jdGlvbiBzaG93TmF2YmFyKCkge1xuICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmFkZChzaG93TmF2YmFyQ2xhc3MpO1xuICB9XG5cbiAgZnVuY3Rpb24gaGlkZU5hdmJhcigpIHtcbiAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoc2hvd05hdmJhckNsYXNzKTtcbiAgfVxuXG4gIHRvZ2dsZU5hdmJhckJ0bi5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgZnVuY3Rpb24gKCkge1xuICAgIGlmICghaXNTbWFsbFNjcmVlbigpICYmIGVub3VnaERlbGF5KCkpIHtcbiAgICAgIHNob3dOYXZiYXIoKTtcbiAgICB9XG4gIH0pO1xuXG4gIG5hdmJhci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgZnVuY3Rpb24gKCkge1xuICAgIGlmICghaXNTbWFsbFNjcmVlbigpICYmIGVub3VnaERlbGF5KCkpIHtcbiAgICAgIGhpZGVOYXZiYXIoKTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBhY3RpdmVCdXR0b24ocGFnZU5hbWVQYXJhbSkge1xuICB2YXIgcGFnZU5hbWUgPSB2b2lkIDA7XG4gIHZhciBuYXZiYXJBY3RpdmVCdXR0b24gPSB2b2lkIDA7XG4gIHZhciBidXR0b25zQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5hdmlnYXRpb24tYnV0dG9ucycpO1xuXG4gIC8vIEZpcnN0IHdlIHRyeSBhbmQgZ2V0IHRoZSBwYWdlIG5hbWUgZnJvbSBhIHBhcmFtZXRlclxuICBpZiAocGFnZU5hbWVQYXJhbSkge1xuICAgIHBhZ2VOYW1lID0gcGFnZU5hbWVQYXJhbTtcbiAgICBwYWdlTmFtZSA9IENTUy5lc2NhcGUocGFnZU5hbWUpO1xuICAgIG5hdmJhckFjdGl2ZUJ1dHRvbiA9IGJ1dHRvbnNDb250YWluZXIucXVlcnlTZWxlY3RvcignW25hbWU9JyArIHBhZ2VOYW1lICsgJ10nKTtcbiAgfVxuXG4gIC8vIElmIGl0IHdhc24ndCBzdWNjZXNzZnVsbCB3ZSB0cnkgdG8gZ2V0IGl0IGZyb20gYSBnbG9iYWwgb2JqZWN0XG4gIGlmICghbmF2YmFyQWN0aXZlQnV0dG9uICYmICh0eXBlb2YgUEFHRV9JTkZPID09PSAndW5kZWZpbmVkJyA/ICd1bmRlZmluZWQnIDogYmFiZWxIZWxwZXJzLnR5cGVvZihQQUdFX0lORk8pKSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIFBBR0VfSU5GTy5uYW1lID09PSAnc3RyaW5nJykge1xuICAgIHBhZ2VOYW1lID0gUEFHRV9JTkZPLm5hbWU7XG4gICAgcGFnZU5hbWUgPSBDU1MuZXNjYXBlKHBhZ2VOYW1lKTtcbiAgICBuYXZiYXJBY3RpdmVCdXR0b24gPSBidXR0b25zQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ1tuYW1lPScgKyBwYWdlTmFtZSArICddJyk7XG4gICAgLy8gVGhlbiB3ZSBqdXN0IHNheSBpdCBpcyBob21lLlxuICB9XG5cbiAgLy8gSWYgd2Ugc3RpbGwgZG9uJ3QgaGF2ZSBpdCBsZXQncyB0cnkgdG8gZ3Vlc3MgZnJvbSB0aGUgdXJsLlxuICBpZiAoIW5hdmJhckFjdGl2ZUJ1dHRvbikge1xuICAgIHZhciBwYXRobmFtZSA9IGxvY2F0aW9uLnBhdGhuYW1lO1xuICAgIHZhciBwYWdlTmFtZVJlZ2V4ID0gL1xcLyhbXlxcLl0rKSg/OlxcLi4qKT8kLztcbiAgICB2YXIgcGFnZU5hbWVNYXRjaCA9IHBhdGhuYW1lLm1hdGNoKHBhZ2VOYW1lUmVnZXgpIHx8IFtdO1xuICAgIHBhZ2VOYW1lID0gcGFnZU5hbWVNYXRjaFsxXTtcbiAgICBwYWdlTmFtZSA9IENTUy5lc2NhcGUocGFnZU5hbWUpO1xuICAgIG5hdmJhckFjdGl2ZUJ1dHRvbiA9IGJ1dHRvbnNDb250YWluZXIucXVlcnlTZWxlY3RvcignW25hbWU9JyArIHBhZ2VOYW1lICsgJ10nKTtcbiAgfVxuXG4gIC8vIElmIHdlIHN0aWxsIGRpZG4ndCBnZXQgYW55dGhpbmcsIGxldCdzIG5vdCBhY3RpdmF0ZSB0aGUgaGlnaGxpZ2h0ZXIuXG4gIGlmICghbmF2YmFyQWN0aXZlQnV0dG9uKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGFzc2VydChuYXZiYXJBY3RpdmVCdXR0b24sICdFcnJvciBmaW5kaW5nIG5hdmJhclxcJ3MgYWN0aXZlIGJ1dHRvbi4nKTtcblxuICAvLyBHZXQgYWxsIG5hdmlnYXRpb24gYnV0dG9uc1xuICB2YXIgbmF2YmFyQnV0dG9ucyA9IGJ1dHRvbnNDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnbGknKTtcbiAgYXNzZXJ0KG5hdmJhckJ1dHRvbnMgJiYgbmF2YmFyQnV0dG9ucy5sZW5ndGggPiAwLCAnTm8gbmF2aWdhdGlvbiBidXR0b25zIGZvdW5kJyk7XG4gIG5hdmJhckJ1dHRvbnMgPSBBcnJheS5mcm9tKG5hdmJhckJ1dHRvbnMpO1xuXG4gIC8vIFJlbW92ZSBpdGVtcyB3aXRoIG5hdmlnYXRpb24gYnV0dG9ucyBmcm9tIG5hdmJhckJ1dHRvbiBhcnJheVxuICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWU7XG4gIHZhciBfZGlkSXRlcmF0b3JFcnJvciA9IGZhbHNlO1xuICB2YXIgX2l0ZXJhdG9yRXJyb3IgPSB1bmRlZmluZWQ7XG5cbiAgdHJ5IHtcbiAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSBuYXZiYXJCdXR0b25zW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXA7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IChfc3RlcCA9IF9pdGVyYXRvci5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZSkge1xuICAgICAgdmFyIGl0ZW0gPSBfc3RlcC52YWx1ZTtcblxuICAgICAgaWYgKGl0ZW0ucXVlcnlTZWxlY3RvcignLm5hdmJhci1idXR0b24nKSkge1xuICAgICAgICB2YXIgaXRlbUluZGV4ID0gbmF2YmFyQnV0dG9ucy5pbmRleE9mKGl0ZW0pO1xuICAgICAgICBuYXZiYXJCdXR0b25zLnNwbGljZShpdGVtSW5kZXgsIDEpO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhhbmRsZSBoaWdobGlnaHQgaW4gdGhlc2UgYnV0dG9uc1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBfZGlkSXRlcmF0b3JFcnJvciA9IHRydWU7XG4gICAgX2l0ZXJhdG9yRXJyb3IgPSBlcnI7XG4gIH0gZmluYWxseSB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiAmJiBfaXRlcmF0b3IucmV0dXJuKSB7XG4gICAgICAgIF9pdGVyYXRvci5yZXR1cm4oKTtcbiAgICAgIH1cbiAgICB9IGZpbmFsbHkge1xuICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yKSB7XG4gICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIG5ldyBBY3RpdmVIaWdobGlnaHRlcih7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tbmV3XG4gICAgYnV0dG9uczogbmF2YmFyQnV0dG9ucyxcbiAgICBhY3RpdmVJbmRleDogbmF2YmFyQnV0dG9ucy5pbmRleE9mKG5hdmJhckFjdGl2ZUJ1dHRvbiksXG4gICAgaGlnaGxpZ2h0T25DbGljazogdHJ1ZVxuICB9KTtcbn1cblxuLy8gQXNzaWducyBhbiBldmVudCBsaXN0ZW5lciB0byBzZWFyY2hCYXI7XG5mdW5jdGlvbiBpbml0U2VhcmNoQmFyVG9nZ2xlKCkge1xuICB2YXIgc2VhcmNoQnV0dG9uU2VsZWN0b3IgPSAnLndlYnNpdGUtc2VhcmNoJztcbiAgdmFyIHNlYXJjaEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VhcmNoQnV0dG9uU2VsZWN0b3IpO1xuICBhc3NlcnQoc2VhcmNoQnV0dG9uICYmIHNlYXJjaEJ1dHRvbi5ub2RlTmFtZSwgJ05vIHNlYXJjaCBidXR0b24gZm91bmQuJyk7XG5cbiAgdmFyIG5hdmJhckNvbnRhaW5lclNlbGVjdG9yID0gJy5uYXZiYXItY29udGFpbmVyJztcbiAgdmFyIG5hdmJhckNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmF2YmFyQ29udGFpbmVyU2VsZWN0b3IpO1xuICBhc3NlcnQobmF2YmFyQ29udGFpbmVyICYmIG5hdmJhckNvbnRhaW5lci5ub2RlTmFtZSwgJ05vIG5hdmJhciBjb250YWluZXIgZm91bmQuJyk7XG5cbiAgdmFyIG5hdmJhckRyb3Bkb3duU2VsZWN0b3IgPSAnLm5hdmJhci1kcm9wZG93bi1zZWFyY2gnO1xuICB2YXIgbmF2YmFyRHJvcGRvd24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hdmJhckRyb3Bkb3duU2VsZWN0b3IpO1xuICBhc3NlcnQobmF2YmFyRHJvcGRvd24gJiYgbmF2YmFyRHJvcGRvd24ubm9kZU5hbWUsICdObyBuYXZiYXIgZHJvcGRvd24gZm91bmQuJyk7XG5cbiAgZnVuY3Rpb24gc2hvd1NlYXJjaEJhcigpIHtcbiAgICBuYXZiYXJDb250YWluZXIuY2xhc3NMaXN0LmFkZChzZWFyY2hCYXJPcGVuQ2xhc3MpO1xuICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzZWFyY2hEaXNtaXNzKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGhpZGVTZWFyY2hCYXIoKSB7XG4gICAgbmF2YmFyQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoc2VhcmNoQmFyT3BlbkNsYXNzKTtcbiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc2VhcmNoRGlzbWlzcyk7XG4gIH1cblxuICAvLyBkaXNtaXNzIHNlYXJjaCBiYXIgd2hlbiBjbGlja2luZyBhbnl3aGVyZSBlbHNlIGluIHRoZSB3ZWJzaXRlLlxuICBmdW5jdGlvbiBzZWFyY2hEaXNtaXNzKGUpIHtcbiAgICB2YXIgZHJvcGRvd25Cb3ggPSBuYXZiYXJEcm9wZG93bi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICB2YXIgY2xpY2tXaWR0aGluWCA9IGUuY2xpZW50WCA8IGRyb3Bkb3duQm94LnJpZ2h0ICYmIGUuY2xpZW50WCA+IGRyb3Bkb3duQm94LmxlZnQ7XG4gICAgdmFyIGNsaWNrV2lkdGhpblkgPSBlLmNsaWVudFkgPCBkcm9wZG93bkJveC5ib3R0b20gJiYgZS5jbGllbnRZID4gZHJvcGRvd25Cb3gudG9wO1xuICAgIGlmICghY2xpY2tXaWR0aGluWSB8fCAhY2xpY2tXaWR0aGluWCkge1xuICAgICAgaGlkZVNlYXJjaEJhcigpO1xuICAgIH1cbiAgfVxuXG4gIHZhciBzZWFyY2hCYXJPcGVuQ2xhc3MgPSAnZHJvcGRvd24tc2VhcmNoLW9wZW4nO1xuICBzZWFyY2hCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgIGlmIChuYXZiYXJDb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKHNlYXJjaEJhck9wZW5DbGFzcykpIHtcbiAgICAgIGhpZGVTZWFyY2hCYXIoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gSWYgd2UgZG9uJ3Qgc3RvcCB0aGUgcHJvcGFnYXRpb24sIHRoZSBkaXNtaXNzIGV2ZW50IHdpbGwgYmVcbiAgICAgIC8vIGZpcmVkIGZvciB0aGlzIHNhbWUgY2xpY2suXG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgc2hvd1NlYXJjaEJhcigpO1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGluaXRTZWFyY2hCYXJCdXR0b25zKCkge1xuICB2YXIgc2VhcmNoRm9ybVNlbGVjdG9yID0gJy5qcy1uYXZiYXItZHJvcGRvd24tc2VhcmNoJztcbiAgdmFyIHNlYXJjaEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlYXJjaEZvcm1TZWxlY3Rvcik7XG4gIGFzc2VydChzZWFyY2hGb3JtICYmIHNlYXJjaEZvcm0ubm9kZU5hbWUsICdObyBzZWFyY2ggZm9ybSBmb3VuZC4nKTtcblxuICB2YXIgcmVudEJ0blNlbGVjdG9yID0gJy5qcy1uYXZiYXItZHJvcGRvdy1zZWFyY2gtcmVudC1idG4nO1xuICB2YXIgcmVudEJ0blRhcmdldCA9ICcvcmVudCc7XG4gIHZhciByZW50QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihyZW50QnRuU2VsZWN0b3IpO1xuICBhc3NlcnQocmVudEJ0biAmJiByZW50QnRuLm5vZGVOYW1lLCAnTm8gcmVudCBidXR0b24gZm91bmQuJyk7XG5cbiAgcmVudEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICBzZWFyY2hGb3JtLmFjdGlvbiA9IHJlbnRCdG5UYXJnZXQ7XG4gICAgc2VhcmNoRm9ybS5zdWJtaXQoKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGNvbnRyb2xOYXZiYXIocGFnZU5hbWUpIHtcbiAgaGlkZUFuZFNob3coKTtcbiAgYWN0aXZlQnV0dG9uKHBhZ2VOYW1lKTtcbiAgaW5pdFNlYXJjaEJhclRvZ2dsZSgpO1xuICBpbml0U2VhcmNoQmFyQnV0dG9ucygpO1xufVxuXG52YXIgRWxldmF0b3IgPSBmdW5jdGlvbiBFbGV2YXRvcihuKSB7XG4gIFwidXNlIHN0cmljdFwiO1xuICBmdW5jdGlvbiB0KG4sIHQsIGUsIG8pIHtcbiAgICByZXR1cm4gbiAvPSBvIC8gMiwgMSA+IG4gPyBlIC8gMiAqIG4gKiBuICsgdCA6IChuLS0sIC1lIC8gMiAqIChuICogKG4gLSAyKSAtIDEpICsgdCk7XG4gIH1mdW5jdGlvbiBlKG4sIHQpIHtcbiAgICBmb3IgKHZhciBlIGluIHQpIHtcbiAgICAgIHZhciBvID0gdm9pZCAwID09PSBuW2VdICYmIFwiZnVuY3Rpb25cIiAhPSB0eXBlb2YgZTtvICYmIChuW2VdID0gdFtlXSk7XG4gICAgfXJldHVybiBuO1xuICB9ZnVuY3Rpb24gbyhuKSB7XG4gICAgZm9yICh2YXIgdCA9IDA7IG47KSB7XG4gICAgICB0ICs9IG4ub2Zmc2V0VG9wIHx8IDAsIG4gPSBuLm9mZnNldFBhcmVudDtcbiAgICB9cmV0dXJuIHQ7XG4gIH1mdW5jdGlvbiBsKG4pIHtcbiAgICBUIHx8IChUID0gbik7dmFyIGUgPSBuIC0gVCxcbiAgICAgICAgbyA9IHQoZSwgaywgQyAtIGssIGIpO3dpbmRvdy5zY3JvbGxUbygwLCBvKSwgYiA+IGUgPyB3ID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGwpIDogcigpO1xuICB9ZnVuY3Rpb24gaSgpIHtcbiAgICByZXR1cm4gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSAmJiB3aW5kb3cuQXVkaW8gJiYgd2luZG93LmFkZEV2ZW50TGlzdGVuZXI7XG4gIH1mdW5jdGlvbiB1KCkge1xuICAgIFQgPSBudWxsLCBrID0gbnVsbCwgaCA9ICExO1xuICB9ZnVuY3Rpb24gYSgpIHtcbiAgICB5ICYmIChDID0gbyh5KSk7XG4gIH1mdW5jdGlvbiByKCkge1xuICAgIHUoKSwgZiAmJiAoZi5wYXVzZSgpLCBmLmN1cnJlbnRUaW1lID0gMCksIEEgJiYgQS5wbGF5KCksIHAgJiYgcCgpO1xuICB9ZnVuY3Rpb24gZCgpIHtcbiAgICBoICYmIChjYW5jZWxBbmltYXRpb25GcmFtZSh3KSwgdSgpLCBmICYmIChmLnBhdXNlKCksIGYuY3VycmVudFRpbWUgPSAwKSwgYSgpLCB3aW5kb3cuc2Nyb2xsVG8oMCwgQykpO1xuICB9ZnVuY3Rpb24gYyhuKSB7XG4gICAgbi5hZGRFdmVudExpc3RlbmVyID8gbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgRi5lbGV2YXRlLCAhMSkgOiBuLmF0dGFjaEV2ZW50KFwib25jbGlja1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBhKCksIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgPSBDLCBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCA9IEMsIHdpbmRvdy5zY3JvbGwoMCwgQyk7XG4gICAgfSk7XG4gIH1mdW5jdGlvbiBzKG4pIHtcbiAgICB2ID0gZG9jdW1lbnQuYm9keTt2YXIgdCA9IHsgZHVyYXRpb246IHZvaWQgMCwgbWFpbkF1ZGlvOiAhMSwgZW5kQXVkaW86ICExLCBwcmVsb2FkQXVkaW86ICEwLCBsb29wQXVkaW86ICEwLCBzdGFydENhbGxiYWNrOiBudWxsLCBlbmRDYWxsYmFjazogbnVsbCB9O24gPSBlKG4sIHQpLCBuLmVsZW1lbnQgJiYgYyhuLmVsZW1lbnQpLCBpKCkgJiYgKG4uZHVyYXRpb24gJiYgKEUgPSAhMCwgYiA9IG4uZHVyYXRpb24pLCBuLnRhcmdldEVsZW1lbnQgJiYgKHkgPSBuLnRhcmdldEVsZW1lbnQpLCB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgZCwgITEpLCBuLm1haW5BdWRpbyAmJiAoZiA9IG5ldyBBdWRpbyhuLm1haW5BdWRpbyksIGYuc2V0QXR0cmlidXRlKFwicHJlbG9hZFwiLCBuLnByZWxvYWRBdWRpbyksIGYuc2V0QXR0cmlidXRlKFwibG9vcFwiLCBuLmxvb3BBdWRpbykpLCBuLmVuZEF1ZGlvICYmIChBID0gbmV3IEF1ZGlvKG4uZW5kQXVkaW8pLCBBLnNldEF0dHJpYnV0ZShcInByZWxvYWRcIiwgXCJ0cnVlXCIpKSwgbi5lbmRDYWxsYmFjayAmJiAocCA9IG4uZW5kQ2FsbGJhY2spLCBuLnN0YXJ0Q2FsbGJhY2sgJiYgKG0gPSBuLnN0YXJ0Q2FsbGJhY2spKTtcbiAgfXZhciBtLFxuICAgICAgZixcbiAgICAgIEEsXG4gICAgICBwLFxuICAgICAgdiA9IG51bGwsXG4gICAgICB3ID0gbnVsbCxcbiAgICAgIGIgPSBudWxsLFxuICAgICAgRSA9ICExLFxuICAgICAgVCA9IG51bGwsXG4gICAgICBrID0gbnVsbCxcbiAgICAgIEMgPSAwLFxuICAgICAgeSA9IG51bGwsXG4gICAgICBoID0gITEsXG4gICAgICBGID0gdGhpczt0aGlzLmVsZXZhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgaCB8fCAoaCA9ICEwLCBrID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCB8fCB2LnNjcm9sbFRvcCwgYSgpLCBFIHx8IChiID0gMS41ICogTWF0aC5hYnMoQyAtIGspKSwgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGwpLCBmICYmIGYucGxheSgpLCBtICYmIG0oKSk7XG4gIH0sIHMobik7XG59O1xuXG5jb250cm9sTmF2YmFyKCk7XG5cbndpbmRvdy5lbGV2YXRvciA9IEVsZXZhdG9yOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
